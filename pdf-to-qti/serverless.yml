service: pdf-to-qti-converter

frameworkVersion: '3'

provider:
  name: aws
  runtime: python3.11
  region: us-east-1
  timeout: 900  # 15 minutes (Lambda max)
  memorySize: 3008  # Near max for better performance
  architecture: x86_64

  environment:
    QTI_VALIDATION_ENDPOINT: http://qti-validator-prod.eba-dvye2j6j.us-east-2.elasticbeanstalk.com/validate

functions:
  convertPdfToQti:
    handler: lambda_handler.lambda_handler
    description: Converts PDF questions to QTI 3.0 XML format with validation
    url:
      cors: true
    timeout: 900
    memorySize: 3008
    environment:
      FUNCTION_NAME: convertPdfToQti

  questionDetail:
    handler: question_detail_handler.handler
    description: Extracts detailed metadata from question PDFs
    url:
      cors: true
    timeout: 900
    memorySize: 3008
    environment:
      FUNCTION_NAME: questionDetail

plugins:
  - serverless-python-requirements

custom:
  pythonRequirements:
    dockerizePip: true
    layer: false
    zip: false
    slim: false
    strip: false
    dockerImage: python:3.11
    pythonBin: python3.11
    dockerRunCmdExtraArgs: ['--platform', 'linux/amd64']
